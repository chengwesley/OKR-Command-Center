# OKR 戰情室 (OKR Command Center)

**版本：** 1.0 (穩定版)
**最後更新：** 2025年6月10日

## 專案簡介

「OKR 戰情室」是一個基於 **Google Sheets** 和 **Google Apps Script** 打造的輕量級 OKR (Objectives and Key Results) 管理系統。它旨在幫助團隊與企業視覺化各層級目標的對齊關係、即時追蹤關鍵結果的進度，並透過互動式的儀表板進行高效管理。

本系統的核心是將複雜的組織目標，以清晰、直觀的心智圖呈現，讓每一位成員都能理解自己的工作如何貢獻於公司的整體策略。

## 核心功能

#### 1. 三層級 OKR 管理
- **分層結構**：完整支援「公司」、「部門」、「個人」三個層級的 OKR 設定。
- **線上操作**：提供網頁介面，方便使用者新增、編輯、更新、刪除各層級的 Objectives (O) 和 Key Results (KR)。
- **進度批次更新**：支援在單一介面中，快速更新多個 KR 的進度。

#### 2. 互動式心智圖儀表板
- **靜態全覽視圖**：預設一次性呈現從「公司」到「部門KR」的完整目標對齊樹，讓管理者對組織目標有全盤的了解。
- **豐富視覺元素**：
    - **狀態色帶**：在卡片左側用綠、橘、紅等顏色清晰標示每個項目的狀態 (On Track, Off Track 等)。
    - **環形進度環**：在 KR 節點上以儀表板風格的圓環直觀顯示完成度百分比。
    - **未承接目標高亮**：自動將沒有被下一層級承接的公司 KR 用紅色邊框標示，凸顯組織斷點。
    - **層級漸層背景**：卡片背景色根據其在組織中的層級深度，呈現由淺到深的漸層，增強空間感。
- **強大互動功能**：
    - **智慧搜尋**：可即時搜尋目標名稱或負責人，高亮顯示符合條件的節點。
    - **一鍵聚焦**：可一鍵高亮所有由「目前登入者」負責的 OKR。
    - **路徑高亮**：滑鼠懸停在任一節點上，會自動高亮其到公司根目標的完整對齊路徑。
    - **點擊詳情**：點擊任一節點可直接彈出其詳細資訊或留言視窗，作為整個系統的導航中樞。

#### 3. 報表與審批
- **數據儀表板**：提供多種圖表，分析公司與部門的 OKR 達成率。
- **審批中心**：提供一個集中的介面，供管理者審批待處理的 OKR。
- **評論功能**：支援在每個 O 或 KR 上進行留言，方便團隊溝通。

## 技術棧

- **後端**：Google Apps Script (JavaScript)
- **資料庫**：Google Sheets
- **前端**：HTML, CSS, JavaScript
- **前端框架/函式庫**：
    - Tailwind CSS (via CDN)
    - D3.js (v5.16.0)
    - Chart.js
    - jQuery

## 安裝與部署

1.  **建立 Google Sheet**：
    - 建立一個新的 Google 試算表。並建立以下名稱的工作表 (Sheet)：
      `Users`, `Company_Objectives`, `Department_Objectives`, `My_Objectives`, `Key_Results`, `Comments`
    - 根據我們測試資料的欄位，在每個工作表中建立對應的**標題列 (Headers)**。

2.  **建立 Apps Script 專案**：
    - 在該試算表內，透過頂部選單「擴充功能」>「Apps Script」建立一個綁定的腳本專案。

3.  **複製程式碼**：
    - 將我們最終版的後端程式碼，完整貼上到 `Code.gs` 檔案中。
    - 建立一個名為 `index.html` 的 HTML 檔案，並將我們最終版的前端程式碼完整貼上。

4.  **更新試算表 ID**：
    - 在 `Code.gs` 的最上方，找到 `SPREADSHEET_ID` 這個常數。
    - 將其值，換成您自己的試算表 ID。（ID 位於試算表網址中，例如 `.../spreadsheets/d/**THIS_IS_THE_ID**/edit`）

5.  **填入資料**：
    - 將您的實際 OKR 資料，或我們之前使用的測試資料，分別填入對應的工作表中。**請務必確保所有關聯 ID (如 `ObjectiveID`, `ParentCompanyKR`) 的準確性。**

6.  **部署 Web App**：
    - 在 Apps Script 編輯器中，點擊右上角的「部署」>「新增部署作業」。
    - **類型**選擇「網頁應用程式」。
    - **執行身分**選擇「我」。
    * **誰可以存取**選擇「知道這個網址的任何人」或您組織的網域。
    - 點擊「部署」，並授予必要的權限。

7.  **取得網址**：
    - 部署成功後，複製產生的 `/exec` (正式版) 和 `/dev` (測試版) 網址即可開始使用。

## 未來可擴充功能

- **前端篩選器**：增加按鈕，一鍵篩選出所有「Off Track」或特定狀態的項目。
- **表單優化**：在新增 O 或 KR 的表單中，使用下拉選單來選擇父項目，從根本上避免 ID 填寫錯誤。
- **歷史快照**：建立一個 Apps Script 時間觸發器，每週自動記錄一次所有 KR 的進度，以便未來進行趨勢分析。

---

## 授權條款 (License)

本專案採用 **[創用 CC 姓名標示-非商業性 4.0 國際 (CC BY-NC 4.0)](https://creativecommons.org/licenses/by-nc/4.0/deed.zh_TW)** 授權條款。

簡單來說，在遵守此授權條款的前提下：

- **您可以自由**：分享、重製、散布、及修改本專案。
- **惟需遵照下列條件**：
  - **姓名標示 (BY)**：您必須給予適當的姓名標示，並提供指向本授權條款的連結。
  - **非商業性 (NC)**：您不得將本專案及基於本專案的衍生作品用於商業目的。

若您希望將此專案用於商業用途，必須事先與原作者聯繫並取得明確的書面授權。

- **您可以自由**：分享、重製、散布、及修改本專案。
- **惟需遵照下列條件**：
  - **姓名標示 (BY)**：您必須給予適當的姓名標示，並提供指向本授權條款的連結。
  - **非商業性 (NC)**：您不得將本專案及基於本專案的衍生作品用於商業目的。

若您希望將此專案用於商業用途，必須事先與原作者Wesley Cheng聯繫並取得明確的書面授權。

📩 Email: wesleylavie@gmail.com
